<!DOCTYPE html>
<html>
<head><title>Hello world</title></head>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io();
    //Called when current user enteres username; go to server end
    function setUsername(){
        socket.emit('setUsername', document.getElementById('name').value);
    };
    var user;
    var roomno;
    //error if user exists already
    socket.on('userExists', function(data){
        document.getElementById('error-container').innerHTML = data;
    });

    //error if rooms are all full
    socket.on('fullRooms', function(data){
        document.getElementById('error-container').innerHTML = data;
    });


    //set current user to username, then change display to chat room
    socket.on('userSet', function(data){
        user = data.username;
        roomno = data.room;
        document.body.innerHTML = '<input type = "text" id = "message">\
        <button type = "button" name = "button" onclick = "sendMessage()">Send</button>\
        <div id = "message-container"></div>';
    });

    //gets called when user prompts to send a message; takes message and user who said it, and outputs to server-side
    function sendMessage(){

        var msg = document.getElementById('message').value;
        if (msg){
            socket.emit('msg', {message: msg, user: user});
        }
    }

    //output new message to user
    socket.on('newmsg', function(data){
        if(user){
            document.getElementById('message-container').innerHTML += '<div><b>' + data.user + '</b>: ' + data.message + '</div>'
        }
    });

    socket.on('disconnectedUser', function(data){
        document.body.innerHTML = '';
        document.write(data);
    });










    /*ROOMS
    var socket = io();
    socket.on('connectToRoom', function(data){
        document.body.innerHTML = '';
        document.write(data);
    });
    */



    /*CUSTOM NAMESPACES
    var socket = io('/my-namespace');
    socket.on('hi', function(data){
        document.body.innerHTML = '';
        document.write(data);
    });*/


    /*MULTIPLE CLIENTS
        socket.on('newClientConnect', function(data){
        document.body.innerHTML = '';
        document.write(data.description);
    });*/
</script>
<body>
    <div id="error-container"></div>
    <input id="name" type = "text" name = "name" value = "" placeholder = "Enter your Username!">
    <button type = "button" name = "button" onclick="setUsername()"> Let's chat!!!</button>
</body>
</html>